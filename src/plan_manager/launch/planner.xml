<launch>


    <arg name="odometry_topic" />
    <arg name="cloud_topic" />
    <arg name="drone_id"/>
    <arg name="max_vel" />
    <arg name="max_acc" />
    <arg name="planning_horizon" />
    <arg name="flight_type" />
    <arg name="use_distinctive_trajs"/>


    <!-- <node pkg="plan_env" name="drone_$(arg drone_id)_node" type="env_node" output="screen"> -->
    <node pkg="plan_manage" name="drone_$(arg drone_id)_node" type="ego_planner_node" output="screen">
        <remap from="~odom_world" to="/drone_$(arg drone_id)/$(arg odometry_topic)"/>
        <remap from="~planning/bspline" to = "/drone_$(arg drone_id)/planning/bspline"/>

        


        <!-- fsm -->
        <rosparam file="$(find state_machine)/cfg/fsm_params.yaml"/>
        <!-- env manager -->
        <remap from="~cloud" to="/drone_$(arg drone_id)/$(arg cloud_topic)"/>
        <remap from="~odom"  to="/drone_$(arg drone_id)/odometry"/>
        <rosparam file="$(find env_manager)/cfg/env_manager_params.yaml"/>
    
        <!-- plan manager -->
        <rosparam command="load" file="$(find plan_manager)/cfg/plan_manager_params.yaml" />


    </node>

    <!-- trajectory server -->
    <node pkg="plan_manager" name="traj_server" type="traj_server" output="screen">
        <remap from="~position_cmd" to="drone_$(arg drone_id)/planning/pos_cmd" />
        <remap from="~planning/bspline" to="drone_$(arg drone_id)/planning/bspline" />

        <param name="traj_server/time_forward" value="1.0" type="double" />
    </node>

</launch>