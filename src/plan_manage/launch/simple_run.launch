<launch>


    <arg name="odom_topic" value="odometry"/>
    <arg name="drone_id" value="0"/>


    <include file="$(find plan_manage)/launch/map.launch">
        <arg name="map_size_x" value="20.0"/>
        <arg name="map_size_y" value="10.0"/>
        <arg name="map_size_z" value="4.0"/>
        <arg name="odom_topic" value="/drone_$(arg drone_id)/$(arg odom_topic)"/>
        <arg name="drone_id" value="$(arg drone_id)"/>
    </include>

    <include file="$(find plan_manage)/launch/simulator.launch">
        <arg name="init_x_" value="0"/>
        <arg name="init_y_" value="0"/>
        <arg name="init_z_" value="0.1"/>
        <arg name="odom_topic" value="/drone_$(arg drone_id)/$(arg odom_topic)"/>
        <arg name="drone_id" value="$(arg drone_id)"/>
    </include>  


    <!-- <node pkg="dynamic_tracker" name="cluster_test_node" type="cluster_test_node" output="screen">
        <param name="cluster_type" value="1"/>
        <param name="epsilon" value="0.4"/>
        <param name="min_points" value="5"/>
        <param name="odom_topic" value="/drone_$(arg drone_id)/odometry"/>
        <param name="cloud_topic" value="/dynamic_map_generator/local_cloud"/>
        <param name="use_adaptive_dbscan" value="true"/>
    </node> -->

    <node name="particle_map" pkg="plan_env" type="dsp_map_node" output="screen">

        <param name="pose_type" value="2" type="int"/>
        <param name="frame_id" value="world" type="string"/>
        <param name="odom_lidar_timeout" value="0.35" type="double"/>
        <param name="local_update_range_x" value="10" type="double"/>
        <param name="local_update_range_y" value="10" type="double"/>
        <param name="local_update_range_z" value="4" type="double"/>
        <param name="enable_virtual_wall" value="false" type="bool"/>
        <param name="virtual_ceil" type="double" value="10"/>
        <param name="virtual_ground" type="double" value="0"/>
        <param name="half_fov_horizontal" type="double" value="180"/>
        <param name="half_fov_vertical" type="double" value="50"/>
        <param name="lidar_topic" type="string" value="/dynamic_map_generator/local_cloud"/>
        <param name="pose_topic" type="string" value="pose"/>
        <param name="odom_topic" type="string" value="/drone_$(arg drone_id)/odometry"/>
        <param name="occupancy_thresh" value="0.1" type="double"/>
        <param name="risk_thresh" value = "0.05" type="double"/>
        <param name="enable_future_prediction" value="true" type="bool"/>
        <param name="prediction_z_height" value="0.3" type="double"/>
        <param name="prediction_y_offset" value="25" type="double"/>
        <param name="dynamic_cluster_max_center_height" value="10.0" type="double"/>

        <!-- update paramters  -->
        <param name="position_prediction_stddev" type="double" value="0.05"/>
        <param name="velocity_prediction_stddev" type="double" value="0.05"/>
        <param name="new_born_particle_weight" type="double" value="0.0001"/>
        <param name="new_born_particle_number_each_point" type="int" value="30"/>
        <param name="voxel_filter_resolution" type="double" value="0.2"/>
        <param name="sigma_ob" type="double" value="0.1"/>

        

    </node>

    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find plan_manage)/config/default.rviz" required="true" />

</launch>